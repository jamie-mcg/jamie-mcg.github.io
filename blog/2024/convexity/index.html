<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Convexity Explained | Jamie McGowan </title> <meta name="author" content="Jamie McGowan"> <meta name="description" content="A short and easy to follow primer on convexity."> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/artificial-intelligence.png?696be420326cea5b9a828337e7a77226"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://jamie-mcg.github,io/blog/2024/convexity/"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?0afe9f0ae161375728f7bcc5eb5b4ab4"></script> </head> <body class="fixed-top-nav sticky-bottom-footer"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Jamie </span> McGowan </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fa-solid fa-moon"></i> <i class="fa-solid fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Convexity Explained</h1> <p class="post-meta"> February 11, 2024 </p> <p class="post-tags"> <a href="/blog/2024"> <i class="fa-solid fa-calendar fa-sm"></i> 2024 </a>   ·   <a href="/blog/tag/math"> <i class="fa-solid fa-hashtag fa-sm"></i> math</a>   <a href="/blog/tag/optimisation"> <i class="fa-solid fa-hashtag fa-sm"></i> optimisation</a>     ·   <a href="/blog/category/mathematics"> <i class="fa-solid fa-tag fa-sm"></i> mathematics</a>   </p> </header> <article class="post-content"> <div id="markdown-content"> <h2 id="what-is-convexity">What is convexity?</h2> <blockquote> <p>A function is convex if the line segment between two points lies above the function.</p> </blockquote> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/blogs/convexity/jensens-480.webp 480w,/assets/img/blogs/convexity/jensens-800.webp 800w,/assets/img/blogs/convexity/jensens-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/blogs/convexity/jensens.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> A visual representation of a convex function with an intersection forming an enclosed area above the curve. Figure created by author. </div> <p>In the above figure, we see an illustrative example of the definition above. Here, we can see that if the intersection of the line forms an enclosed area which is uninterrupted above the curve, the function can be considered convex.</p> <p>We can also see that if the opposite is true i.e. the enclosed area is below the curve, the function is concave!</p> <p>Indeed, a convex function \(f(x)\) can be reflected into a concave function \(-f(x)\).</p> <p>Mathematically, convexity is best described by Jensen’s inequality,</p> <p>\(f(E[X]) \le E[f(X)]\) for a convex function \(f\) and a random vector \(X\) that is within the domain of \(f\). Now, I find it hard to conceptualise inequalities at face value, so let’s chat about it a bit…</p> <p>Jensen’s inequality essentially states that the expected value of a convex transformation of a random variable (i.e. \(E[f(X)]\)) is more than or equal to the value of the convex function evaluated at the mean od the random variable (i.e. \(f(E[X])\)) - or the gap between these two is never negative.</p> <p>OK, I’ll be honest, when I wrote that, it only half made sense to me… I’m a physicist by background and so I love drawings and building intuitions visually, so let’s do that!</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/blogs/convexity/jensens_inequality-480.webp 480w,/assets/img/blogs/convexity/jensens_inequality-800.webp 800w,/assets/img/blogs/convexity/jensens_inequality-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/blogs/convexity/jensens_inequality.gif" class="img-fluid rounded z-depth-1" width="100%" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> An animated representation of Jensen's inequality. Figure created by author. </div> <p>Consider the figure above, here it is a lot easier to see what Jensen’s inequality is really saying. Basically the LHS of Jensen’s inequality is represented by the green dotted line - this is taking the average of the two red \(x\) points and then evaluating the function at this point (i.e. \(f(E[X])\)). Whereas, the intersection of the red dashed line and the green dotted line is what the RHS of Jensen’s inequality is describing - evaluating the function before taking the expectation (i.e. \(E[f(X)]\)).</p> <p>We can see that over the entire range of this function, the green dot never crosses the red line and so the intersection of the green dotted and red dashed lines is always above the blue solid curve.</p> <p>OK, hopefully that was a nice and easy to follow explanation for you! And if it wasn’t, at least you got to distract yourself with a cool animation! Anyway, let’s get back to convexity…</p> <p>OK, so as well as Jensen’s inequality, for a twice differentiable function which is convex, we have two rather nice conditions:</p> \[f^{''}(x) &gt;= 0 \qquad \forall x, \\ f(y) &gt;= f(x) + \nabla f(x)^{T} (y-x).\] <p>The first of these conditions tells us that curvature must be positive everywhere. The second condition ensures that the line between two points \(x\) and \(y\) lies above the function within that interval (illustrated earlier).</p> <p>Following on from this, the first condition ensures that a convex function must curve upwards (or not at all). Therefore, if we find a minima x, any movement away from this point will result in an increase in the function value.</p> <p>Together, these conditions are enough to guarantee that any minima found in a convex function must be a global minima (although this doesn’t necessarily need to be unique). This is extremely useful for techniques such as stochastic Gradient Descent since if we find a local minima (something which Gradient Descent generally tends to find), we can be certain that this in fact the global minima - the best possible solution.</p> <h2 id="the-strong-the-strict-and-the-standard">The Strong, the Strict and the Standard</h2> <p>As always with math, we don’t just have one type of something, we have some vague terms that sound cool to describe some more features.</p> <p>Convex functions are no exception and can be further categorised with three properties:</p> <ul> <li>Convex</li> <li>Strictly Convex</li> <li>Strongly Convex</li> </ul> <p>Now, the further you move down that list, the stronger these properties become (hence the “strongly” term). This just means that the subset of convex functions that have these properties becomes smaller due to stronger constraints.</p> <p>So far in this post, we have been talking about convexity in its most general form, where \(f^{''}(x) &gt;= 0\). This is the condition for ‘convex’ functions.</p> <p>Strictly convex functions are those which satisfy \(f^{''}(x) &gt; 0\), i.e. the curvature can never be 0.</p> <p>Stongly convex functions are those which satisfy \(f^{''}(x) &gt;= m &gt; 0\), where the curvature is non-vanishing and stays bounded below by some positive value \(m\).</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/blogs/convexity/strong_and_strict-480.webp 480w,/assets/img/blogs/convexity/strong_and_strict-800.webp 800w,/assets/img/blogs/convexity/strong_and_strict-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/blogs/convexity/strong_and_strict.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> A plot showing examples of different types of convex functions. Figure created by author. </div> <p>In the above plot, we can see the differences between these types of convexities visually. If you take the definitions in the legend and differentiate these twice then it is easy to prove to yourself that each of these are convex, strictly convex or strongly convex.</p> <p>OK cool, well done for reading another one of my posts! I’m trying to keep these as short and sweet as possible and just give the “need-to-know” understanding for these concepts. Let me know how I did!</p> </div> </article> </div> </div> <footer class="sticky-bottom mt-5" role="contentinfo"> <div class="container"> © Copyright 2024 Jamie McGowan. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2930004b8d7fcd0a8e00fdcfc8fc9f24"></script> <script defer src="/assets/js/common.js?4a129fbf39254905f505c7246e641eaf"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>